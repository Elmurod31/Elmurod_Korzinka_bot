<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootstrap Layout</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="main.css">
</head>
<body class="bg-danger">


<div class="container-fluid mt-3">


    <div id="carouselExampleRide" class="carousel slide" data-bs-ride="true">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <div class="d-flex flex-column" style="height: 75vh;">
                    <img src="img_28.png" class="img-fluid w-100 h-75 flex-grow-1 object-fit-cover" alt="...">
                    <div class="bg-dark text-white text-center py-2">
                        <h1 class="m-0 fs-4">Leys</h1>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="d-flex flex-column" style="height: 75vh;">
                    <img src="img_38.png" class="img-fluid w-100 h-75 flex-grow-1 object-fit-cover" alt="...">
                    <div class="bg-dark text-white text-center py-2">
                        <h1 class="m-0 fs-4">Pepsi</h1>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="d-flex flex-column" style="height: 75vh;">
                    <img src="img_39.png" class="img-fluid w-100 h-75 flex-grow-1 object-fit-cover" alt="...">
                    <div class="bg-dark text-white text-center py-2">
                        <h1 class="m-0 fs-4">Grenki</h1>
                    </div>
                </div>
            </div>
        </div>

z

        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleRide" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleRide" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>


    <div class="row g-3">
        <div class="col-12 bg-white d-flex">
            <p class="text-center text-black p-3 m-0"><a class="nav-link" href="#scrollspyHeading1">Yog'lar</a></p>

            <p class="text-center text-black p-3 m-0"><a class="nav-link" href="#scrollspyHeading2">Go'sht mahsulotlari</a></p>

            <p class="text-center text-black p-3 m-0"><a class="nav-link" href="#scrollspyHeading3">Sut mahsulotlari
            </a></p>
        </div>
    </div>

    <div id="scrollspyHeading1" class="row g-3 mt-5">
        <div class="col-6">
            <img src="img_27.png" class="img-fluid w-100 h-50 bg-white" alt="">
            <h5 class="bg-white text-center m-0">Oleyna Yog'i</h5>
            <h5 class="bg-white text-center m-0 pt-3">32 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Oleyna yog'i" data-price="19000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_29.png" class="img-fluid w-100 h-50 bg-white" alt="">
            <h5 class="bg-white text-center m-0">Zaytun yog'i</h5>
            <h5 class="bg-white text-center m-0 pt-3">29 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Zaytun yog'i" data-price="29000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count1">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_30.png" class="img-fluid w-100 h-50 bg-white" alt="">
            <h5 class="bg-white text-center m-0">O. Tanlov yog'i</h5>
            <h5 class="bg-white text-center m-0 pt-3">26 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Oila Tanlov yog'i" data-price="26000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count2">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_31.png" class="img-fluid w-100 h-50 bg-white" alt="">
            <h5 class="bg-white text-center m-0">Zalatoy Yog'</h5>
            <h5 class="bg-white text-center m-0 pt-3">29 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Zalatoy Yog'" data-price="29000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count3">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
    </div>

    <div id="scrollspyHeading2" class="row g-3 mt-3">
        <div class="col-6">
            <img src="img_24.png" class="img-fluid w-100 h-50 bg-white" alt="">
            <h5 class="bg-white text-center m-0">Kalbasa</h5>
            <h5 class="bg-white text-center m-0 pt-3">35 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Kalbasa" data-price="35000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count4">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_32.png" class="img-fluid w-100 h-50 bg-white " alt="">
            <h5 class="bg-white text-center m-0">Ro'zmetov K.</h5>
            <h5 class="bg-white text-center m-0 pt-3">40 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Ro'zmetov K. 🍔" data-price="40000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count5">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_33.png" class="img-fluid w-100 h-50 bg-white " alt="">
            <h5 class="bg-white text-center m-0">Shirin</h5>
            <h5 class="bg-white text-center m-0 pt-3">37 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Shirin" data-price="37000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count6">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_34.png" class="img-fluid w-100 h-50 bg-white " alt="">
            <h5 class="bg-white text-center m-0">Exstra</h5>
            <h5 class="bg-white text-center m-0 pt-3">30 000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Exstra" data-price="30000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count7">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
    </div>


    <div id="scrollspyHeading3" class="row g-3 mt-3">
        <div class="col-6">
            <img src="img_21.png" class="img-fluid w-100 h-50 bg-white " alt="">
            <h5 class="bg-white text-center m-0">Prezident Siri</h5>
            <h5 class="bg-white text-center m-0 pt-3">28000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Prezident Siri" data-price="28000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count8">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_35.png" class="img-fluid w-100 h-50 bg-white " alt="">
            <h5 class="bg-white text-center m-0">Xanskiy Siri</h5>
            <h5 class="bg-white text-center m-0 pt-3">53000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Xanskiy Siri" data-price="53000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count9">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_36.png" class="img-fluid w-100 h-50 bg-white " alt="">
            <h5 class="bg-white text-center m-0">Sir tayoqchalar</h5>
            <h5 class="bg-white text-center m-0 pt-3">12000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Sir tayoqchalar" data-price="12000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count10">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
        <div class="col-6">
            <img src="img_37.png" class="img-fluid w-100 h-50 bg-white " alt="">
            <h5 class="bg-white text-center m-0">Sir</h5>
            <h5 class="bg-white text-center m-0 pt-3">34000 so'm</h5>
            <div class="bg-white text-center p-3 rounded-bottom" data-name="Sir" data-price="34000">
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="decrement(this)">-</button>
                <span class="px-3 fw-bold" id="count11">0</span>
                <button class="btn btn-light rounded-pill px-2 py-2" onclick="increment(this)">+</button>
            </div>
        </div>
    </div>
    <div class="row">
        <div id="cartBar"
             class="col-12 bg-white d-flex justify-content-between align-items-center position-fixed bottom-0 start-0 end-0 p-3 shadow d-none">
            <h3 class="text-black m-0">Savatni ko'rish</h3>
            <a href="index1.html">
                <button class="box p-2"><h5 class="m-0" id="card">Savatchani ko'rish</h5></button>
            </a>
        </div>
    </div>


</div>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<script>
    let tg = window.Telegram.WebApp;
    tg.expand(); // Telegram oynasini to'liq ochish

    function updateMainButton() {
        const cart = JSON.parse(localStorage.getItem("cart")) || {};
        if (Object.keys(cart).length === 0) {
            tg.MainButton.hide();
        } else {
            tg.MainButton.setText("Buyurtmani yuborish");
            tg.MainButton.show();
        }
    }

    function increment(button) {
        const countSpan = button.previousElementSibling;
        let count = parseInt(countSpan.textContent) + 1;
        countSpan.textContent = count;

        const productDiv = button.closest("div[data-name]");
        const name = productDiv.getAttribute("data-name");
        const price = productDiv.getAttribute("data-price");

        let cart = JSON.parse(localStorage.getItem("cart")) || {};

        if (cart[name]) {
            cart[name].count += 1;
        } else {
            cart[name] = {
                price: price,
                count: 1
            };
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        updateMainButton();
    }

    function decrement(button) {
        const countSpan = button.nextElementSibling;
        let count = parseInt(countSpan.textContent);
        if (count === 0) return;

        countSpan.textContent = count - 1;

        const productDiv = button.closest("div[data-name]");
        const name = productDiv.getAttribute("data-name");

        let cart = JSON.parse(localStorage.getItem("cart")) || {};

        if (cart[name]) {
            cart[name].count -= 1;
            if (cart[name].count <= 0) {
                delete cart[name];
            }
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        updateMainButton();
    }

    // Telegram MainButton bosilganda: JSON qilib yuborish
    tg.MainButton.onClick(() => {
        const cart = JSON.parse(localStorage.getItem("cart")) || {};
        const items = Object.entries(cart).map(([name, data]) => ({
            name: name,
            price: data.price,
            count: data.count
        }));

        tg.sendData(JSON.stringify(items)); // JSON ko‘rinishida botga yuborish

        // Storage tozalash
        localStorage.removeItem("cart");

        // UI tozalash
        document.querySelectorAll(".counter span").forEach(span => {
            span.textContent = "0";
        });

        updateMainButton();
    });

    updateMainButton(); // sahifa ochilganda tekshirish
</script>
</body>
</html>